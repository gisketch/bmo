services:
  qdrant:
    image: qdrant/qdrant:latest
    ports:
      - "6333:6333"
      - "6334:6334"
    volumes:
      - ./qdrant_data:/qdrant/storage
    restart: unless-stopped

  agent:
    build:
      context: .
      dockerfile: Dockerfile
    command: ["uv", "run", "agent.py", "dev"]
    env_file: .env.local
    environment:
      - LIVEKIT_AGENTS_LOG_FORMAT=text
    network_mode: host
    restart: unless-stopped

  web:
    build:
      context: .
      dockerfile: frontend/Dockerfile
      args:
        - LIVEKIT_API_KEY=${LIVEKIT_API_KEY}
        - LIVEKIT_API_SECRET=${LIVEKIT_API_SECRET}
        - LIVEKIT_URL=${LIVEKIT_PUBLIC_URL}
    ports:
      - "3001:3001"
    restart: unless-stopped
    depends_on:
      - agent
