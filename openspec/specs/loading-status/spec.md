# loading-status Specification

## Purpose
Defines the loading status data-channel message that allows the agent to send visual loading feedback to the frontend during network-bound tool calls (e.g., obsidian-query). The frontend displays a typewriter-animated status message via the LoadingWithInfo component.

## Requirements

### Requirement: Loading status data-channel message
The agent SHALL publish a loading status message to the LiveKit room data channel on topic `loading-status` with payload `{ "type": "loading-status", "text": "<message>" }` using reliable delivery. This message is sent before executing a network-bound tool call to inform the frontend of the pending operation.

#### Scenario: Agent sends loading status before obsidian query
- **WHEN** the `obsidian-query` tool is invoked with a `loading_message` parameter
- **THEN** the agent publishes `{ "type": "loading-status", "text": "<loading_message>" }` on topic `loading-status` before executing the search

### Requirement: Loading status tool parameter
The `obsidian-query` tool SHALL accept a required `loading_message: str` parameter in addition to the existing `query: str` parameter. The `loading_message` SHALL contain a short, BMO-flavored status phrase generated by the LLM describing what the tool is about to do.

#### Scenario: LLM provides loading message with obsidian query
- **WHEN** the LLM calls `obsidian-query` with query "SSS number" and loading_message "Scanning digital brain for number thingies"
- **THEN** the agent publishes the loading status message with text "Scanning digital brain for number thingies" and then executes the obsidian search with query "SSS number"

### Requirement: Prompt rule for loading message
The system prompt SHALL include a rule instructing BMO to always provide a `loading_message` when calling `obsidian-query`. The message SHALL be a short, creative, BMO-style phrase describing what BMO is searching for. The prompt SHALL provide examples to guide the LLM's phrasing.

#### Scenario: Prompt includes loading message instruction
- **WHEN** the system prompt is composed
- **THEN** it includes a tool rule for `obsidian-query` that requires a `loading_message` parameter with BMO-style phrasing guidance
